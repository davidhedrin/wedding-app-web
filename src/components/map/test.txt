Pada project next.js 16. Bagiamana cara membuat semacam select lokasi langsung dari maps gitu. Lalu kordinatnya disimpan kedatabase. Lalu nantinya dipakai data itu ketika view data dan langsung menampilkan lokasi mapsnya gitu. Paham kan maksd saya??

Paham ğŸ‘
Yang kamu mau itu **flow klasik â€œpick location from map â†’ simpan koordinat â†’ tampilkan lagi di mapâ€**.
Di Next.js 16 ini **sangat doable** dan sudah best-practice kalau dipisah **client â†” server**.

Aku jelasin **step by step + arsitekturnya**, biar kebayang jelas.

---

## Gambaran Besar Alurnya

1. **User klik lokasi di Map**
2. Kita ambil **latitude & longitude**
3. Simpan ke **database (Prisma)**
4. Saat view data â†’ **render map lagi + marker di koordinat itu**

![Image](https://miro.medium.com/0%2AYbQm8Fo32qpyQYwA.jpg)

![Image](https://www.maptive.com/wp-content/uploads/2023/01/latitude-latitude-google-maps-1024x728.jpg)

![Image](https://www.maptive.com/wp-content/uploads/2021/01/Latitude_and_Longitude_of_the_Earth.svg)

![Image](https://www.maptive.com/wp-content/uploads/2023/01/latitude-latitude-google-maps.jpg)

---

## 1ï¸âƒ£ Pilih Library Map (Rekomendasi)

### ğŸ”¥ PALING REKOMENDED

**Leaflet + OpenStreetMap**

* Gratis
* Tidak perlu API key
* Ringan
* Cocok untuk Next.js

ğŸ“¦ Package:

```bash
npm install leaflet react-leaflet
```

---

## 2ï¸âƒ£ Struktur Database (Prisma)

ğŸ“„ `schema.prisma`

```prisma
model Location {
  id        String   @id @default(cuid())
  name      String
  latitude  Float
  longitude Float
  createdAt DateTime @default(now())
}
```

```bash
npx prisma migrate dev
```

---

## 3ï¸âƒ£ Map Picker (Client Component)

ğŸ“„ `components/MapPicker.tsx`

```tsx
"use client"

import { MapContainer, TileLayer, Marker, useMapEvents } from "react-leaflet"
import { useState } from "react"
import "leaflet/dist/leaflet.css"

function LocationMarker({ onSelect }: { onSelect: (lat: number, lng: number) => void }) {
  useMapEvents({
    click(e) {
      onSelect(e.latlng.lat, e.latlng.lng)
    },
  })
  return null
}

export default function MapPicker({
  onChange,
}: {
  onChange: (lat: number, lng: number) => void
}) {
  const [position, setPosition] = useState<[number, number] | null>(null)

  return (
    <MapContainer
      center={[-6.2, 106.816666]} // Jakarta default
      zoom={13}
      style={{ height: "400px", width: "100%" }}
    >
      <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" />
      <LocationMarker
        onSelect={(lat, lng) => {
          setPosition([lat, lng])
          onChange(lat, lng)
        }}
      />
      {position && <Marker position={position} />}
    </MapContainer>
  )
}
```

âœ”ï¸ Klik map â†’ dapat koordinat
âœ”ï¸ Marker otomatis muncul

---

## 4ï¸âƒ£ Form Simpan Lokasi

ğŸ“„ `app/location/create/page.tsx`

```tsx
"use client"

import { useState } from "react"
import MapPicker from "@/components/MapPicker"

export default function CreateLocation() {
  const [lat, setLat] = useState<number | null>(null)
  const [lng, setLng] = useState<number | null>(null)

  async function saveLocation() {
    await fetch("/api/location", {
      method: "POST",
      body: JSON.stringify({ latitude: lat, longitude: lng }),
    })
  }

  return (
    <>
      <MapPicker
        onChange={(lat, lng) => {
          setLat(lat)
          setLng(lng)
        }}
      />

      <button onClick={saveLocation} disabled={!lat || !lng}>
        Simpan Lokasi
      </button>
    </>
  )
}
```

---

## 5ï¸âƒ£ API Route (SERVER)

ğŸ“„ `app/api/location/route.ts`

```ts
import { prisma } from "@/lib/prisma"

export async function POST(req: Request) {
  const { latitude, longitude } = await req.json()

  const location = await prisma.location.create({
    data: {
      name: "Lokasi Baru",
      latitude,
      longitude,
    },
  })

  return Response.json(location)
}
```

---

## 6ï¸âƒ£ Tampilkan Lokasi di Map (View Data)

ğŸ“„ `components/MapViewer.tsx`

```tsx
"use client"

import { MapContainer, TileLayer, Marker } from "react-leaflet"

export default function MapViewer({
  lat,
  lng,
}: {
  lat: number
  lng: number
}) {
  return (
    <MapContainer
      center={[lat, lng]}
      zoom={15}
      style={{ height: "400px" }}
    >
      <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" />
      <Marker position={[lat, lng]} />
    </MapContainer>
  )
}
```

---

## ğŸ” Flow Data (Ringkas)

```
Map click
   â†“
lat/lng (client)
   â†“
API Route
   â†“
Database (Prisma)
   â†“
Fetch data
   â†“
MapViewer (marker muncul)
```

---

## ğŸ’¡ Enhancement (Optional Tapi Keren)

* ğŸ“ Reverse geocoding (lat/lng â†’ alamat)
* ğŸ” Search lokasi (autocomplete)
* ğŸ§­ Drag marker
* ğŸ“± Mobile friendly

Kalau kamu mau, aku bisa:

* Buatin **Google Maps versi**
* Tambahin **search lokasi**
* Contoh **real case: lokasi wedding / event**
* Atau integrasi **Mapbox**

Tinggal bilang mau yang mana ğŸ˜„
